WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:02.500
大家好 欢迎回来

00:00:02.500 --> 00:00:07.040
现在我们要开始创建网络了

00:00:07.040 --> 00:00:11.500
这是网络的总体结构 大家可以看看

00:00:11.500 --> 00:00:13.820
输入就像之前说的

00:00:13.820 --> 00:00:16.844
我们不打算用独热编码处理

00:00:16.844 --> 00:00:18.675
我们要输入的是整数

00:00:18.675 --> 00:00:22.510
所以我们要把整数传递到这个隐藏层里 也就是嵌入层

00:00:22.510 --> 00:00:25.519
这只是线性神经元

00:00:25.518 --> 00:00:27.799
所以我们完全不需用激活函数

00:00:27.800 --> 00:00:29.600
毕竟神经元是线性的 接着

00:00:29.600 --> 00:00:33.478
下一层是 softmax 输出层

00:00:33.478 --> 00:00:35.345
记住

00:00:35.345 --> 00:00:38.314
我们传递的是现有线性文本

00:00:38.314 --> 00:00:39.899
目的是获取目标单词

00:00:39.899 --> 00:00:47.170
所以我们要用这个 softmax 层来预测目标单词

00:00:47.170 --> 00:00:49.929
等我们训练好这一切后

00:00:49.929 --> 00:00:52.280
隐藏层

00:00:52.280 --> 00:00:55.195
就会形成这些

00:00:55.195 --> 00:00:59.265
包含语义的单词向量表征

00:00:59.265 --> 00:01:00.880
而这才是我们真正感兴趣的

00:01:00.880 --> 00:01:04.540
我们关心的就只是这些表征而已

00:01:04.540 --> 00:01:05.829
这就是我们的目的

00:01:05.828 --> 00:01:07.929
我们就是要把单词转为向量

00:01:07.930 --> 00:01:09.969
也就是说 训练好后

00:01:09.968 --> 00:01:12.180
就可以把这个 softmax 层抛开了

00:01:12.180 --> 00:01:14.108
我们不用再管这一层了

00:01:14.108 --> 00:01:15.313
这一层的作用

00:01:15.313 --> 00:01:17.033
就是训练出

00:01:17.034 --> 00:01:20.709
输入和隐藏层之间的权重而已

00:01:20.709 --> 00:01:25.810
所以你要做的第一件事就是创建输入

00:01:25.810 --> 00:01:31.594
所以你要用 TensorFlow 占位符来创建输入

00:01:31.593 --> 00:01:34.899
因为我们要传递的是整数

00:01:34.900 --> 00:01:39.149
所以你得把数据类型设为 tf.int32

00:01:39.149 --> 00:01:43.739
因为我们要传递的批次大小随机

00:01:43.739 --> 00:01:48.450
所以要将批大小设为随机

00:01:48.450 --> 00:01:50.599
因而设为 none

00:01:50.599 --> 00:01:54.500
这样当你传递批次时 TensorFlow 就会自行处理

00:01:54.500 --> 00:01:59.655
要让代码能实现后面的操作

00:01:59.655 --> 00:02:02.254
标签 也就是目标 也即占位符

00:02:02.254 --> 00:02:05.799
的第二维度应设为 none 或 1

00:02:05.799 --> 00:02:09.780
这就是输入节点了

00:02:09.780 --> 00:02:14.400
我们来看下面的嵌入层

00:02:14.400 --> 00:02:17.754
你要在这里创建嵌入层

00:02:17.753 --> 00:02:21.823
首先 创建嵌入矩阵

00:02:21.824 --> 00:02:23.835
这个矩阵的大小

00:02:23.835 --> 00:02:26.955
是词典单词数

00:02:26.955 --> 00:02:30.909
与所需嵌入维数的乘积

00:02:30.908 --> 00:02:33.495
比如 你有一万个单词

00:02:33.495 --> 00:02:39.908
三百个隐藏单元 也即嵌入维数 那矩阵大小就是 10000 乘以 300

00:02:39.908 --> 00:02:43.989
所以你要在这里设置

00:02:43.990 --> 00:02:47.080
嵌入特征数 也即嵌入维数

00:02:47.080 --> 00:02:50.395
然后在这里创建嵌入权重矩阵

00:02:50.395 --> 00:02:52.925
记住 要用 tf.variable 来创建

00:02:52.925 --> 00:02:58.485
然后用 tf.nn.embedding_lookup 来进行查询

00:02:58.485 --> 00:03:04.599
你可以浏览一下这里的文献

00:03:04.598 --> 00:03:12.110
基本上就是相继把权重矩阵和一些整数传递给函数 函数就会进行查询了

00:03:12.110 --> 00:03:15.818
或者你也可以传递整数张量 这样函数就会查询那些张量

00:03:15.818 --> 00:03:21.318
从而得出隐藏层的值

00:03:21.318 --> 00:03:23.818
剩下的就交给你了

00:03:23.818 --> 00:03:29.649
总地来说 你要创建输入和嵌入层

00:03:29.650 --> 00:03:32.408
如果需要帮助 可以参考我的方案

00:03:32.408 --> 00:03:35.188
下一个视频我也会对方案进行讲解

