WEBVTT
Kind: captions
Language: zh-CN

00:00:00.000 --> 00:00:04.644
又见面了 现在我来讲怎么创建这个网络

00:00:04.644 --> 00:00:09.868
我们会讲到输入、嵌入层和 softmax 层

00:00:09.868 --> 00:00:13.435
和之前一样 用 TensorFlow 的占位符函数  tf.placeholder

00:00:13.435 --> 00:00:17.963
这两个占位符都要用整数 也就是 tf.n32

00:00:17.963 --> 00:00:23.928
还要用批大小和第二维度都随机的标签

00:00:23.928 --> 00:00:26.838
所以在处理输入和标签时

00:00:26.838 --> 00:00:31.195
实际我们要传递的就是整数

00:00:31.195 --> 00:00:33.829
当我第一次做这件事时

00:00:33.829 --> 00:00:35.234
也就是当我第一次创建这个网络时

00:00:35.234 --> 00:00:37.195
我以为两个都可以这么写

00:00:37.195 --> 00:00:40.384
但之后当我在实现网络的某个部分时

00:00:40.384 --> 00:00:46.640
那些需要第二维度的标签总是会出错

00:00:46.640 --> 00:00:48.840
这种情况还挺常见的

00:00:48.840 --> 00:00:51.059
创建时你以为只需做一件事

00:00:51.058 --> 00:00:55.483
可随着你不断深入 你发现漏洞层出不穷

00:00:55.484 --> 00:00:58.200
所以你不得不回到前面

00:00:58.200 --> 00:01:01.215
修改网络 从而解决网络后面出现的问题

00:01:01.215 --> 00:01:03.539
好了 然后是嵌入层

00:01:03.539 --> 00:01:09.525
把嵌入维数设为 200 为了设置嵌入权重

00:01:09.525 --> 00:01:16.308
我创建了个变量 使用随机均匀分布的函数 random_uniform

00:01:16.308 --> 00:01:19.109
权重张量的大小

00:01:19.108 --> 00:01:22.798
则是词汇量大小与嵌入层大小的乘积

00:01:22.799 --> 00:01:26.114
然后将范围初始化为 -1 到 1

00:01:26.114 --> 00:01:28.915
然后做嵌入查询表

00:01:28.915 --> 00:01:33.459
所以就这么写 tf.nn.embedding_lookup 然后是嵌入和输入

00:01:33.459 --> 00:01:38.745
这样你就得到了嵌入张量

00:01:38.745 --> 00:01:41.754
其实就是隐藏层的值

00:01:41.754 --> 00:01:46.144
总地来说 使用嵌入

00:01:46.144 --> 00:01:48.215
要进行的操作都是一样的

00:01:48.215 --> 00:01:53.754
创建嵌入矩阵 将输入传递给嵌入矩阵

00:01:53.754 --> 00:01:55.409
从而得到这个嵌入层

00:01:55.409 --> 00:02:01.219
然后你就可以把嵌入层传递给网络了

00:02:01.218 --> 00:02:04.870
好了 最后是负采样

00:02:04.870 --> 00:02:11.098
还是为 softmax 层创建权重和偏置

00:02:11.098 --> 00:02:15.848
用截断正态分布函数 truncated_normal 把权重初始化

00:02:15.848 --> 00:02:17.638
所以

00:02:17.639 --> 00:02:23.110
定义权重大小为词汇量的大小和嵌入层的大小

00:02:23.110 --> 00:02:26.310
标准差设为 0.1

00:02:26.310 --> 00:02:31.335
偏置全部初始化为 0 大小是词汇量的大小

00:02:31.335 --> 00:02:34.080
要用负采样计算损失

00:02:34.080 --> 00:02:36.930
我们要用函数 sampled_softmax_loss

00:02:36.930 --> 00:02:38.645
要传递给函数的参数有权重、偏置、

00:02:38.645 --> 00:02:44.604
标签、嵌入层、n_sampled

00:02:44.604 --> 00:02:50.039
n_sampled 是们要采样的负样本数

00:02:50.038 --> 00:02:53.179
然后是词汇量的大小

00:02:53.180 --> 00:02:57.911
运行这个负采样 计算损失

00:02:57.911 --> 00:03:01.340
得到损失 用 AdamOptimizer 将其最小化

